{% extends "./frame.html" %}
{% load humanize %}

{% block title %}Search{% endblock %}

{% block content %}
    <h4>Search</h4>

    <form action="{% url 'surf:search' %}" method='get'>
        {% csrf_token %}
        {{form}}
        <input type='submit' value='Search' />
    </form>

    {% if form.is_bound %}
        <h4 class='search-results'>Search results</h4>

        <div class='result-count'>{{num_of_results}} results found.</div>
    {% endif %}

    {% if results %}
        <table class='more_reports'>
            <thead>
                <th>Index</th>
                <th>Id</th>
                <th>Captured at</th>
                <th class='swell'>Swell From</th>
                <th class='swell'>Swell To</th>
                <th class='tag'>Tags</th>
            </thead>

            {% for report in results %}
                <tr class="{% cycle 'row_a' 'row_b' %}" data-url="{% url 'surf:surf_report' report.id %}">
                    <td>{{forloop.counter}}</td>
                    <td>{{report.id}}</td>
                    <td>{{report.captured_at|naturaltime}}</td>
                    <td class='swell'>{{report.min_swell|floatformat:2}}m</td>
                    <td class='swell'>{{report.max_swell|floatformat:2}}m</td>
                    <td class='tags'>
                        {% for tag in report.tags.all %}
                            <a href="{% url 'surf:show_tag' tag.id %}" class='tag'>{{tag.label}}</a>
                        {% endfor %}
                    </td>
                </tr>
            {% endfor %}
        </table>
    {% endif %}

{% endblock %}
